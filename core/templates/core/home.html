{% extends 'account/base.html' %}
{% load static %}
{% load core_extras %}

{% block content %}
    <div class="mb-5">
        <legend class="">Recent Requests</legend>
        <hr>

        {% if not reqs %}
            <div class="content-section text-center text-secondary">
                <i>No requests</i>
            </div>
        {% endif %}

        {% for req in reqs|slice:"0:3" %}
            <article class="content-section my-3">
                <div class="media">
                    {% if req.user.profile %}
                    <img class="mr-2 rounded-circle article-img" src="{{ req.user.profile.avatar.url }}" height="25px" width="25px">
                    {% else %}
                    <img class="mr-2 rounded-circle article-img" src="{% url 'media-server' filename='default-avatar.jpg' %}" height="25px" width="25px">
                    {% endif %}
                    <div class="article-metadata" style="">
                        <a class="anchor mr-2" href="{% url 'profile' username=req.user.username %}">{{ req.user }}</a>
                        <small class="text-muted">{{ req.date }}</small>
                    </div>
                </div>

                <div class="media-body">
                    <hr class="my-2 py-0">

                    <div class="">
                        <h4><a class="article-title" href="{% url 'request-details' req_id=req.id %}">{{ req.title }}</a></h4>
                        <!-- <h6 class="article-content">{{ req.description }}</h6> -->
                    </div>

                    <small>
                        {% if req.is_closed %}
                            <a class="anchor tag px-2" style="color: green; background: #a2f2cf;">Completed</a>
                        {% endif %}
                        <a class="anchor tag px-2" href="{% url 'all-requests' %}{% urlparams branch=req.branch %}">{{ req.branch }}</a>
                        <a class="anchor tag px-2" href="{% url 'all-requests' %}{% urlparams semester=req.semester %}">Semester: {{ req.semester }}</a>
                    </small>

                </div>
            </article>
        {% endfor %}

        {% if reqs|length > 3 %}
            <div class="">
                <a class="btn btn-sm btn-block btn-outline-info" style="" href="{% url 'all-requests'%}">See all requests</a>
            </div>
        {% endif %}
    </div>
    <hr class="w-50">

    <div class="mb-5">
        <legend class="">Recent Uploads</legend>
        <hr>

        {% if not files %}
            <div class="content-section text-center text-secondary">
                <i>No Files</i>
            </div>
        {% endif %}

        {% for file in files|slice:"0:3" %}
            <article class="content-section">
                <div class="media">
                    {% if file.user.profile %}
                        <img class="mr-2 rounded-circle article-img" src="{{ file.user.profile.avatar.url }}" height="25px" width="25px">
                    {% else %}
                        <img class="mr-2 rounded-circle article-img" src="{% url 'media-server' filename='default-avatar.jpg' %}" height="25px" width="25px">
                    {% endif %}
                    
                    <div class="article-metadata" style="">
                        <a class="anchor mr-2" href="{% url 'profile' username=file.user.username %}">{{ file.user }}</a>
                        <small class="text-muted">{{ file.upload_date }}</small>
                    </div>
                </div>

                <div class="media-body">
                    <hr class="my-2 py-0">

                    <div class="">
                        <h4><a class="article-title" href="{% url 'download' %}{% urlparams fileid=file.id%}">{{ file.filename }}</a></h4>
                        <h6 class="article-content">{{ file.description }}</h6>
                    </div>

                    <small>
                        <a class="anchor tag px-2" href="{% url 'all-uploads' %}{% urlparams branch=file.branch %}">{{ file.branch }}</a>
                        <a class="anchor tag px-2" href="{% url 'all-uploads' %}{% urlparams semester=file.semester %}">Semester: {{ file.semester }}</a>
                    </small>
                </div>
            </article>
        {% endfor %}

        {% if files|length > 3 %}
            <div class="">
                <form>
                    <button class="btn btn-sm btn-block btn-outline-info" style="" formaction="{% url 'all-uploads' %}">See all files</button>
                </form>
            </div>
        {% endif %}
    </div>

{% endblock content %}
